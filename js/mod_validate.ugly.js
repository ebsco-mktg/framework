var VALIDATE=function(pub){function debounce(fn,delay){var timer=null;return function(){var context=this,args=arguments;clearTimeout(timer);timer=setTimeout(function(){fn.apply(context,args);console.log("fn apply")},delay)}}pub.setClass=function(aElem,aClass){try{var aElem=$(aElem)[0];if(aElem.className.indexOf(aClass)===-1){if(aElem.className===""){aElem.className=aClass}else{aElem.className=aElem.className+" "+aClass}}}catch(e){}};pub.removeClass=function(aElem,aClass){try{var aElem=aElem[0];if(aElem.className===aClass){aElem.removeAttribute("class")}else{aElem.className=aElem.className.replace(" "+aClass,"")}}catch(e){console.log(e)}};pub.email=function(aElem){var re=/\S+@\S+\.\S+/,element=$(aElem),thisError=0;if(!re.test(element.val())){thisError=1}return thisError};pub.ebscoEmail=function(aElem){window.console&&console.log("VALIDATE.email",aElem);var re=/\S+@\S+\.\S+/,element=$(aElem),thisError=0;re=/\S+@(?:\S{2}\.){0,1}(?:ebsco){1}(?:host){0,1}(?:\.com)$/;if(!re.test(element.val())){thisError=1}return thisError};pub.radio=function(aElem){var checkName=$(aElem).attr("name"),elementNames=[],thisError=0;elementNames.push(checkName);for(i=0;i<elementNames.length;i++){var thisId=$(this).attr("id"),isChecked=$('input[name="'+elementNames[i]+'"]').is(":checked");if(!isChecked){$("label[for="+thisId+"]").addClass("error");thisError=1}else{$("label[for="+thisId+"]").removeClass("error")}}return thisError};pub.select=function(aElem){};pub.text=function(aElem){var elementVal=aElem.val(),thisError=0;if(elementVal===""){thisError=1;VALIDATE.removeLabel(aElem)}return thisError};pub.testfields=function(aField){var required,submit=$('.form-behavior input[type="submit"], .form-behavior button[type="submit"]'),elementNames=[],error=0;if(aField===undefined){required=$(".required:visible")}else{required=$(aField)}required.each(function(){var $that=$(this),elementType=$that.attr("type"),thisError=0;if($that[0].tagName.toLowerCase()==="select"){elementType="select"}if(elementType==="email"){if($that.hasClass("ebsco-email")){if(VALIDATE.ebscoEmail($that)!==0){thisError=1}}else{if(VALIDATE.email($that)!==0){thisError=1}}}else if(elementType==="radio"){if(VALIDATE.radio($that)!==0){thisError=1}}else if(elementType==="select"){if(VALIDATE.text($that)!==0){thisError=1}}else if(elementType==="checkbox"){if($that.is(":checked")){}else{thisError=1}}else{if(VALIDATE.text($that)!==0){thisError=1}}if(thisError===1){if($that[0].type==="radio"||$that[0].type==="checkbox"){VALIDATE.setClass($that.parent(),"error")}else{VALIDATE.setClass($that,"error")}error=thisError}else{if($that[0].type==="radio"||$that[0].type==="checkbox"){VALIDATE.removeClass($that.parent(),"error")}else{VALIDATE.removeClass($that,"error")}}});VALIDATE.checkSubmitState();return error};pub.checkSubmitState=function(){var submit=$('.form-behavior input[type="submit"], .form-behavior button[type="submit"]'),hasErrors=$(".error").length;if(hasErrors!==0){VALIDATE.setClass(submit,"disabled");submit.attr("disabled","disabled")}else{VALIDATE.removeClass(submit,"disabled");submit.removeAttr("disabled")}};pub.moveLabel=function(inputField){var thisLabel=$('label[for="'+inputField.attr("id")+'"]');if($(inputField)[0].type!=="radio"&&$(inputField)[0].type!=="checkbox"){VALIDATE.setClass(thisLabel,"hasValue")}if($(inputField).parent().hasClass("multiline")){VALIDATE.setClass($(inputField).parent(".multiline"),"active")}if(inputField.hasClass("hasPrefix")){VALIDATE.setClass(inputField.prev(".field-prefix"),"active")}};pub.removeLabel=function(inputField){var thisLabel=$('label[for="'+inputField.attr("id")+'"]');thisLabel.removeClass("hasValue").removeClass("hasBlur");if($(inputField).parent().hasClass("multiline")){VALIDATE.removeClass($(inputField).parent(".multiline"),"active")}if(inputField.hasClass("hasPrefix")){VALIDATE.removeClass(inputField.prev(".field-prefix"),"active")}};pub.hideLabel=function(inputField){var thisLabel=$('label[for="'+inputField.attr("id")+'"]');if(!$(inputField).parent(".form-behavior").hasClass("push-label")){VALIDATE.setClass(thisLabel,"hasBlur")}};pub.checkValue=function(inputField){var thisInputVal=inputField.val();if(thisInputVal!==""){VALIDATE.moveLabel(inputField);if(inputField.is(".required:visible")){VALIDATE.testfields(inputField)}}else{VALIDATE.removeLabel(inputField)}};pub.errorsVisible=function(){var errors=$(".error:visible");return errors.length};pub.init=function(submitMode,varCfg){EIS.loadOnce("jQuery",function(){var submit=$('.form-behavior input[type="submit"], .form-behavior button[type="submit"], .submitForm'),fields=$(".form-behavior").find("input, textarea, select").not(":submit"),thisError=0,countryField=typeof varCfg==="object"&&typeof varCfg.countryField==="string"?varCfg.countryField:"#country",stateField=typeof varCfg==="object"&&typeof varCfg.stateField==="string"?varCfg.stateField:"#state",postalField=typeof varCfg==="object"&&typeof varCfg.postalField==="string"?varCfg.postalField:"#postalcode",countrySelect=$(countryField),stateSelect=$(stateField),postalCode=$(postalField),countriesWithStates="United States, Canada";if(typeof submitMode==="undefined"||submitMode===true){submit.on("click",function(evt){thisError=VALIDATE.testfields();console.log("thisError = ",thisError);if(thisError!==0){VALIDATE.testfields();PROGRESS.setNavBtns();return false}else{$(this).addClass("loading");$("body").css("cursor","progress");$(this).closest("form").submit();return true}})}if($(".fnSetSelect").length>0){var $theSelects=$(".fnSetSelect");$theSelects.each(function(){var thisDataVal=$(this).data("selected");$(this).find('option[value="'+thisDataVal+'"]').attr("selected","selected")})}fields.each(function(){$(this).on({click:function(){VALIDATE.moveLabel($(this))},focus:function(){VALIDATE.moveLabel($(this))},blur:function(){if($(this)[0].type!=="radio"&&$(this)[0].type!=="checkbox"){if($(this).hasClass("datefield")){}else{VALIDATE.checkValue($(this))}}if($(this).hasClass("required")){if($(this).hasClass("datefield")){}else{VALIDATE.testfields($(this))}}PROGRESS.setNavBtns()},change:function(){if($(this).hasClass("required")){VALIDATE.testfields($(this))}PROGRESS.setNavBtns()},keydown:function(){VALIDATE.hideLabel($(this))}});VALIDATE.checkValue($(this))});countrySelect.change(function(){if(countriesWithStates.indexOf(countrySelect.val())!==-1){stateSelect.removeAttr("disabled").addClass("required").removeClass("disabled");stateSelect.children("option").first().text("State / Province*");postalCode.addClass("required").prev("label").text("Zip Code/Postal*")}else{stateSelect.attr("disabled","disabled").val("").removeClass("required error").addClass("disabled");stateSelect.children("option").first().text("field not required");postalCode.removeClass("required error").prev("label").text("Postal Code (optional)")}})})};return pub}(VALIDATE||{});var PROGRESS=function(pub){var allPanels=document.querySelectorAll(".panels"),numPanels=allPanels.length;function getCurrentPanel(){var currPanel={};currPanel.elem=$(".current");currPanel.idx=$(".panels").index(currPanel.elem);return currPanel}function locHashChange(){debug.console("locHashChange");var thisHash=location.hash,thisIdx=+thisHash.split("-")[1],currPanel=getCurrentPanel();if(thisHash!==""){thisError=VALIDATE.testfields();if(thisError!==0){if(thisIdx>=currPanel.idx){PROGRESS.setHash("item"+currPanel.idx);VALIDATE.testfields();PROGRESS.setNavBtns()}else{PROGRESS.move("item"+thisIdx)}}else{PROGRESS.move("item"+thisIdx)}}else{thisError=VALIDATE.testfields();if(thisError!==0){PROGRESS.setHash("item"+currPanel.idx);VALIDATE.testfields();PROGRESS.setNavBtns()}else{PROGRESS.move("item0")}}}pub.locHashChange=function(){locHashChange()};pub.setHash=function(numMoves){var currPanel=getCurrentPanel(),targPanelIdx=0,re=new RegExp("(^item)");if(re.test(numMoves)){targPanelIdx=new Number(numMoves.replace(re,""))}else{targPanelIdx=currPanel.idx+numMoves}if(currPanel.idx!==-1){if(targPanelIdx<numPanels&&targPanelIdx>-1){window.location.hash="#panel-"+targPanelIdx;if($(".lt-ie8").length!==0){debug.log("manual move for IE7");locHashChange()}}}};pub.move=function(numMoves){var currPanel=getCurrentPanel(),targPanelIdx=0,re=new RegExp("(^item)");if(re.test(numMoves)){targPanelIdx=new Number(numMoves.replace(re,""))}else{targPanelIdx=currPanel.idx+numMoves}if(currPanel.idx!==-1){if(targPanelIdx<numPanels&&targPanelIdx>-1){$(currPanel.elem).fadeOut(500,function(){$(allPanels).eq(targPanelIdx).fadeIn(500,function(){$(currPanel.elem).removeClass("current");$(this).addClass("current");PROGRESS.setNavBtns();PROGRESS.setProgress()})})}}};pub.setNavBtns=function(){var currPanel=getCurrentPanel();if(VALIDATE.errorsVisible()>0){$(".button").not(".movePrev").add(".submitForm").addClass("disabled");$(".status-group .note").addClass("highlight")}else{$(".button").add(".submitForm").removeClass("disabled");$(".status-group .note").removeClass("highlight")}if(currPanel.idx+1>numPanels-1){$(".moveNext").addClass("removed")}else{$(".moveNext").removeClass("removed")}if(currPanel.idx-1<0){$(".movePrev").addClass("removed")}else{$(".movePrev").removeClass("removed")}if(currPanel.idx===numPanels-1){$(".submitForm").removeClass("removed")}else{$(".submitForm").addClass("removed")}};pub.setProgress=function(){var widthEach=100/numPanels,currWidth=0,lang=document.documentElement.lang!==""?document.documentElement.lang:"en",dictionary={en:{step:"step",of:"of"},es:{step:"paso",of:"de"}};var currPanel=getCurrentPanel();if(currPanel.idx!==-1){currWidth=(currPanel.idx+1)*widthEach;$(".indicator").css("width",currWidth+"%").text(dictionary[lang].step+" "+new Number(currPanel.idx+1)+" "+dictionary[lang].of+" "+numPanels+" ")}};pub.setIndicatorPoints=function(){var thePoints=[];var theIndicator=simple.getElementsByClassName(document.body,"progress");var widthEach=100/numPanels;for(var i=0;i<numPanels;i++){for(var ii=0,len=allPanels[i].children.length;ii<len;ii++){var thisNode=allPanels[i].children[ii],thisH1Val=allPanels[i].getElementsByTagName("h1")[0].textContent;thePoints.push(thisH1Val)}}for(var iii=0,thisLen=thePoints.length;iii<thisLen;iii++){var span=document.createElement("span");var thisCt=iii;span.className="point";span.style.width=widthEach+"%";span.style.left=widthEach*iii+"%";span.appendChild(document.createTextNode(thePoints[iii]));theIndicator[0].appendChild(span)}$(".point").each(function(idx){$(this).on("click",function(){PROGRESS.move("item"+idx)})})};pub.init=function(){PROGRESS.setNavBtns();PROGRESS.setProgress();if($(".lt-ie8").length<1){window.onhashchange=locHashChange}else{}$(".moveNext").on("click",function(){var visibleFields=$(".required:visible");VALIDATE.testfields(visibleFields);if(VALIDATE.errorsVisible()===0){PROGRESS.setHash(1)}else{$(this).addClass("disabled");$(".status-group .note").addClass("highlight")}return false});$(".movePrev").on("click",function(){PROGRESS.setHash(-1);return false})};return pub}(PROGRESS||{});